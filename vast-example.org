#+TITLE: VAST Example

* Setup

#+BEGIN_SRC R :session *R-vastex*
library(tidyverse)
devtools::load_all("~/src/FishStatsUtils", helpers = FALSE, export_all = FALSE)
devtools::load_all("~/src/VAST", helpers = FALSE, export_all = FALSE)
devtools::load_all("~/src/spatq", helpers = FALSE)
#+END_SRC

#+RESULTS:

From the ~fit_model~ help example:

#+BEGIN_SRC R :session *R-vastex*
## load data set
## see `?load_example` for list of stocks with example data
## that are installed automatically with `FishStatsUtils`.
example = load_example( data_set="EBS_pollock" )

## Make settings
settings = make_settings( n_x=50, Region=example$Region, purpose="index",
                         strata.limits=example$strata.limits )

## Run model
fit = fit_model("settings"=settings, "Lat_i"=example$sampling_data[,'Lat'],
                "Lon_i"=example$sampling_data[,'Lon'], "t_i"=example$sampling_data[,'Year'],
                "c_i"=rep(0,nrow(example$sampling_data)), "b_i"=example$sampling_data[,'Catch_KG'],
                "a_i"=example$sampling_data[,'AreaSwept_km2'], "v_i"=example$sampling_data[,'Vessel'] )

## Plot results
plot_results( settings=settings, fit=fit )
#+END_SRC

#+RESULTS:


#+BEGIN_SRC R :session *R-vastex*
sdr <- fit$parameter_estimates$SD
#+END_SRC

#+RESULTS:


#+BEGIN_SRC R :session *R-vastex*
corr_fixed <- cov2cor(sdr$cov.fixed)
cf_nad <- corr_fixed
cf_nad[abs(cf_nad) < 0.05] <- NA
image(cf_nad[rev(seq_len(nrow(cf_nad))),])
#+END_SRC

#+RESULTS:

*
